<!-- templates/chat.html -->
{% extends 'base.html' %}

{% block content %}
<div class="flex flex-col md:flex-row h-screen w-full md:overflow-hidden relative">

    <!-- Chat conversation container -->
    <div class="md:w-3/5 w-full flex flex-col relative">
        <!-- Chat history area -->
        <div class="overflow-y-auto flex-grow">
            <!-- Insert conversation history here -->
            {% for entry in conversation %}
                {% if entry.type == 'user' %}
                    <!-- User message -->
                    <div class="text-right p-2">
                        <span class="inline-block bg-blue-200 rounded px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">{{ entry.text }}</span>
                    </div>
                {% else %}
                    <!-- Bot message -->
                    <div class="text-left p-2">
                        <span class="inline-block bg-green-200 rounded px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">{{ entry.text }}</span>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- Chat input area -->
    <div class="md:w-3/5 w-full bg-white p-4 border-t-2 fixed bottom-0">
        <form action="/chat" method="post" class="flex w-full">
            <input class="flex-1 border rounded-l px-4 py-2 text-gray-800" id="message" name="message" type="text" placeholder="Type your message">
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r" type="submit">
                Send
            </button>
        </form>
    </div>

    <!-- Right side - Title and Description -->
    <div class="md:w-2/5 w-full bg-white p-4 overflow-y-auto">
        {% if sample_db %}
            <!-- Database title -->
            <h1 class="text-xl font-bold text-gray-900 mb-4">{{ sample_db.name }}</h1>
            <!-- Database description -->
            <div class="prose text-gray-800">{{ description_html|safe }}</div>
        {% endif %}
    </div>

</div>

<script>
    // JavaScript to keep chat scrolled to bottom
    var chatWindow = document.querySelector('.overflow-y-auto.flex-grow');
    chatWindow.scrollTop = chatWindow.scrollHeight;
</script>

{% endblock %}
